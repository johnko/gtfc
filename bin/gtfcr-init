#!/bin/sh

# gtfc init

gitcluster_init() {
  PEERPORT="22"
  TOSPLIT=$1
  if [ "x" != "x${TOSPLIT%@*}" ]; then
    MYUSER="${TOSPLIT%@*}"
  fi
  HOSTANDPORT="${TOSPLIT#*@}"
  if [ "x" != "x${HOSTANDPORT}" ]; then
    HOST="${HOSTANDPORT%:*}"
    PEERPORT="${HOSTANDPORT#*:}"
  fi
  first=$1
  repo=$2

  if [ "x" = "x$first" ]; then
    echo "ERROR: missing arg" >&2
    exit 1



  elif [ "x" = "x$repo" ]; then
    repo="gitsync"
  fi
  ssh -t -p $PEERPORT urep@$HOST gtfc init $first $repo

}

gitcluster_init $1 $2
